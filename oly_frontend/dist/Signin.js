import{d as E,r as f,x as U,g as L,s as N,U as O,G as A,u as q,a as z,o as _,b as h,e,y as B,w as j,A as S,h as t,H as k,I as F,f as b,z as M,t as V,J as $,K as H,l as W,L as G,M as P,N as J,O as K,P as Q,Q as X,R as Y,S as Z,T as ee,V as se,W as ae,p as oe,k as te,_ as re}from"./index.js";import{c as ie,a as R,b as ne,u as le,d as T}from"./object.js";const v=u=>(oe("data-v-0f6ec8fd"),u=u(),te(),u),de={class:"view entry signin"},ce=v(()=>e("p",{class:"welcome"},"Welcome Back",-1)),ue={class:"form"},pe=["onSubmit"],ve={class:"group"},ge=v(()=>e("label",{for:"login_email"},"email",-1)),me={key:0,class:"error"},fe={class:"group"},_e=v(()=>e("label",{for:"login_password"},"password",-1)),he=["type"],we={key:0,class:"error"},ye=W('<div class="prompt" data-v-0f6ec8fd> Signing in or logging in the platform, you automatically accept our <span class="highlight" data-v-0f6ec8fd>privacy</span> and <span class="highlight" data-v-0f6ec8fd>Terms and Conditions</span></div><div class="remember_me" data-v-0f6ec8fd><input type="checkbox" name="" id="" data-v-0f6ec8fd><span data-v-0f6ec8fd>Remember me</span></div><button class="btn_signin" data-v-0f6ec8fd>Sign in</button>',3),Se=v(()=>e("div",{class:"forget_password"},"Forget your password?",-1)),ke=E({__name:"Signin",setup(u){const x=ie({email:R().email("Please input a valid email address").required("Please input a valid email address"),password:R().required("Please input a valid password"),keepMeLogged:ne()}),w=le({validationSchema:x,initialValues:{email:"",password:""}}),l=T("email",void 0,{validateOnValueUpdate:!0}),d=T("password",void 0,{validateOnValueUpdate:!0}),p=f(!1),s=f("login"),a=U(),g=L(O,N),c=A(),C=q(),m=f(!1),D=()=>{C.push({name:"register"})},I=async y=>{if(y.preventDefault(),m.value)return;const{valid:n}=await w.validate();if(!n){a.error("Ooops... invalid login credentials",{timeout:7e3,id:s.value});return}if(!(G||P&&c&&await c.recaptchaLoaded()))return a.error("Oops! Cannot submit request at this time.. Please refresh this page",{id:s.value,timeout:5e3}),!1;m.value=!0,a.info("Logging user...",{id:s.value,timeout:0});try{const r=P?await(c==null?void 0:c.executeRecaptcha("login")):"token",o=await J.post("login",{json:{...w.values,"g-captcha-key":r}});if(o.status===200){const i=await o.json();if(K(i)){Q.isLoading.value=!0,await g.setToken(i.data.token),await g.setState({userData:i.data.user}),a.success("User logged successfully",{id:s.value,timeout:3500}),await g.goToDashboard();return}}else a.error("Please refresh this page...",{id:s.value,timeout:4e3})}catch(r){a.dismiss(s.value),r||window.location.reload(),(async()=>{if(r instanceof X){const o=Y(r,"response.status");if(console.log("status",o),o>=400){const i=await r.response.json();if(console.log("status",o),Z(i))a.error(i.message,{id:s.value,timeout:4e3});else{if(ee(i))return a.error(i.error.message,{id:s.value});if(se(i))return a.error("Authorization Error",{id:s.value})}}}else{if(r instanceof ae)return a.error("Oops! An error occured while sending request. Please check your internet connection",{id:s.value});a.error("An error occurred while logging in user",{id:s.value})}})()}m.value=!1};return(y,n)=>{const r=z("icon");return _(),h("div",de,[ce,e("p",{class:"hint"},[B(" Don't have any account yet? "),e("span",{onClick:D},"Register here")]),e("div",ue,[e("form",{onSubmit:j(I,["prevent"])},[e("div",ve,[ge,e("span",{class:S(["input-icon",{"has-error":t(l).errorMessage.value}])},[k(e("input",{id:"login_email","onUpdate:modelValue":n[0]||(n[0]=o=>t(l).value.value=o),type:"email",name:"email"},null,512),[[F,t(l).value.value]]),b(r,{class:"icon",data:"@/assets/svg-icon/mail.svg?icon"})],2),t(l).errorMessage.value?(_(),h("div",me,M(t(l).errorMessage.value),1)):V("",!0)]),e("div",fe,[_e,e("span",{class:S(["input-icon",{"has-error":t(d).errorMessage.value}])},[k(e("input",{id:"login_password","onUpdate:modelValue":n[1]||(n[1]=o=>t(d).value.value=o),type:p.value?"text":"password",name:"password"},null,8,he),[[$,t(d).value.value]]),b(r,{class:"icon toggle",data:t(H)(p.value),onClick:n[2]||(n[2]=o=>p.value=!p.value)},null,8,["data"])],2),t(d).errorMessage.value?(_(),h("div",we,M(t(d).errorMessage.value),1)):V("",!0)]),ye],40,pe),Se])])}}});const Ve=re(ke,[["__scopeId","data-v-0f6ec8fd"]]);export{Ve as default};
//# sourceMappingURL=Signin.js.map
