import{R as O,d as J,r as x,x as K,g as Q,s as W,U as X,G as Y,v as Z,ac as ee,c as ae,X as se,ad as oe,a as q,o as u,ae as te,h as e,b as m,e as a,y as d,w as re,A as R,H as h,I as A,t as n,z as w,f as I,J as D,K as F,af as ie,i as ne,L as le,M as B,N as ue,ag as de,Q as ce,S as ve,T as pe,V as me,W as ge,p as _e,k as fe,ah as ye,_ as he}from"./index.js";import{c as we,a as S,b as Pe,u as ke,d as P}from"./object.js";const be=c=>t=>{const v=t.target.getAttribute("name");v&&O(c,`values.${v}`)&&c.validateField(v)},g=c=>(_e("data-v-c7806062"),c=c(),fe(),c),Me={key:1,class:"view entry register"},Ve={class:"header_section"},Ce=g(()=>a("h1",null,[d(" Create "),a("span",{class:"highlight"},"Patient"),d("/"),a("span",{class:"highlight"},"Therapist"),d(" Account ")],-1)),xe={class:"grouped"},Re={class:"group small"},Se=g(()=>a("label",{for:"name"},"First Name",-1)),Ne={key:0,class:"error"},Te={class:"group small"},Ue=g(()=>a("label",{for:"name"},"Last Name",-1)),Ie={key:0,class:"error"},Ae={class:"group"},Oe=g(()=>a("label",{for:"register_email"},"email",-1)),Ee={key:0,class:"error"},Le={class:"group"},qe=g(()=>a("label",{for:"register_password"},"password",-1)),De=["type"],Fe={key:0,class:"error"},Be={class:"group"},$e=g(()=>a("label",{for:"register_c_password"},"password confirmation",-1)),ze=["type"],He={key:0,class:"error"},je={class:"privacy_policy"},Ge={for:"privacy_policy"},Je={class:"text"},Ke=g(()=>a("a",{href:"https://www.iubenda.com/privacy-policy/71399601",class:"iubenda-nostyle no-brand iubenda-noiframe iubenda-embed iub-legal-only iubenda-noiframe link",title:"Privacy Policy "}," Privacy Policy ",-1)),Qe={key:0,class:"error"},We=["disabled"],Xe={class:"create"},Ye=J({__name:"Register",setup(c){const t=x("register"),i=K(),v=x(!1),l=Q(X,W),k=Y(),$=Z(),z=ee({loader:()=>ye(()=>import("./emailVerification.js"),["emailVerification.js","index.js","index.css","emailVerification.css"])}),H=we({name:S().required("Please input your first name"),lastName:S().required("Please input you last name"),email:S().email("Please input a valid email address").required("Please input a valid email address"),password:S().required("Please input a valid password"),password_confirmation:S().required("Please confirm your password").test({name:"confirm_password",exclusive:!0,params:{},message:"Password confirmation must match password",test:function(U){return U===this.parent.password}}),privacyPolicy:Pe().required("Please accept to continue").oneOf([!0],"Please accept to continue")}),b=ke({validationSchema:H,initialValues:{name:"",lastName:"",email:O($,"query.email","")||"",password:"",password_confirmation:"",privacyPolicy:!1}}),_=P("name",void 0,{validateOnValueUpdate:!0}),f=P("lastName",void 0,{validateOnValueUpdate:!0}),M=P("email",void 0,{validateOnValueUpdate:!0}),V=P("password",void 0,{validateOnValueUpdate:!0}),C=P("password_confirmation",void 0,{validateOnValueUpdate:!0}),y=P("privacyPolicy",void 0,{validateOnValueUpdate:!0,validateOnMount:!0}),j=ae(()=>(console.log("log",b.meta.value.valid),console.log("log",y.value.value),b.meta.value.valid&&y.value.value)),E=x(!1),G=async U=>{if(U.preventDefault(),v.value)return;const{valid:o}=await b.validate();if(!o){i.error("Ooops... some input / selection is invalid. Please verify inputed / selected data",{timeout:7e3,id:t.value});return}if(!(le||B&&k&&await k.recaptchaLoaded()))return i.error("Ooops.. cannot submit request at this time.. PLease refresh this page",{id:t.value,timeout:5e3}),!1;v.value=!0,i.info("Saving user data...",{id:t.value,timeout:0});try{const r=B?await(k==null?void 0:k.executeRecaptcha("register")):"token";let p=await ue.post("register",{json:{...b.values,firstName:_.value.value,lastName:f.value.value,"g-captcha-key":r}});if(p.status===200){const s=await p.json();de(s)&&(l.setToken(s.data.token),l.setState({userData:s.data.user}),E.value=!0,console.log("log",l.token),console.log("log",l))}i.dismiss(t.value)}catch(r){i.dismiss(t.value),r||window.location.reload(),(async()=>{if(r instanceof ce){const p=O(r,"response.status");if(p>=400){const s=await r.response.json();if(console.log("status",p),ve(s))i.error(s.message,{id:t.value,timeout:4e3});else{if(pe(s))return i.error(s.error.message,{id:t.value});if(me(s))return i.error("Authorization Error",{id:t.value})}}else if(r instanceof ge)return i.error("Ooops.. An error occured while sending request.. PLease check your internet connection",{id:t.value})}console.dir(r)})()}i.dismiss(t.value),v.value=!1},L=be(b);se(()=>{l.tokenCreationReason!==oe.SIGNUP&&l.setState({email:"",tokenCreationReason:null,mode:l.mode==="token-sent"?"unlogged":l.mode})});const N=x(!1),T=x(!1);return(U,o)=>{const r=q("Icon"),p=q("router-link");return E.value?(u(),te(e(z),{key:0})):(u(),m("div",Me,[a("div",Ve,[Ce,a("p",null,[d(" Already have an account? "),a("span",{class:"highlight",onClick:o[0]||(o[0]=re(()=>{},["prevent"]))},"Sign in")])]),a("form",{onSubmit:G,onChange:o[9]||(o[9]=(...s)=>e(L)&&e(L)(...s))},[a("div",xe,[a("div",Re,[Se,a("span",{class:R(["input-icon",{"has-error":e(_).errorMessage.value}])},[h(a("input",{id:"name","onUpdate:modelValue":o[1]||(o[1]=s=>e(_).value.value=s),type:"text",name:"name",placeholder:"First Name"},null,512),[[A,e(_).value.value]]),n(' <span class="edge-text"> Last name </span> ')],2),e(_).errorMessage.value?(u(),m("div",Ne,w(e(_).errorMessage.value),1)):n("v-if",!0)]),a("div",Te,[Ue,a("span",{class:R(["input-icon",{"has-error":e(f).errorMessage.value}])},[h(a("input",{id:"name","onUpdate:modelValue":o[2]||(o[2]=s=>e(f).value.value=s),type:"text",name:"name",placeholder:"Last Name"},null,512),[[A,e(f).value.value]]),n(' <span class="edge-text"> Last name </span> ')],2),e(f).errorMessage.value?(u(),m("div",Ie,w(e(f).errorMessage.value),1)):n("v-if",!0)])]),a("div",Ae,[Oe,a("span",{class:R(["input-icon",{"has-error":e(M).errorMessage.value}])},[h(a("input",{id:"register_email","onUpdate:modelValue":o[3]||(o[3]=s=>e(M).value.value=s),type:"email",name:"email"},null,512),[[A,e(M).value.value]]),I(r,{class:"icon",data:"@/assets/icons/mail.svg?icon"})],2),e(M).errorMessage.value?(u(),m("div",Ee,w(e(M).errorMessage.value),1)):n("v-if",!0)]),a("div",Le,[qe,a("span",{class:R(["input-icon",{"has-error":e(V).errorMessage.value}])},[h(a("input",{id:"register_password","onUpdate:modelValue":o[4]||(o[4]=s=>e(V).value.value=s),type:N.value?"text":"password",name:"password"},null,8,De),[[D,e(V).value.value]]),I(r,{class:"icon toggle",data:e(F)(N.value),onClick:o[5]||(o[5]=s=>N.value=!N.value)},null,8,["data"])],2),e(V).errorMessage.value?(u(),m("div",Fe,w(e(V).errorMessage.value),1)):n("v-if",!0)]),a("div",Be,[$e,a("span",{class:R(["input-icon",{"has-error":e(C).errorMessage.value}])},[h(a("input",{id:"register_c_password","onUpdate:modelValue":o[6]||(o[6]=s=>e(C).value.value=s),type:T.value?"text":"password",name:"cpassword"},null,8,ze),[[D,e(C).value.value]]),I(r,{class:"icon toggle",data:e(F)(T.value),onClick:o[7]||(o[7]=s=>T.value=!T.value)},null,8,["data"])],2),e(C).errorMessage.value?(u(),m("div",He,w(e(C).errorMessage.value),1)):n("v-if",!0)]),a("div",je,[a("label",Ge,[h(a("input",{id:"privacy_policy","onUpdate:modelValue":o[8]||(o[8]=s=>e(y).value.value=s),type:"checkbox",name:"privacyPolicy","true-value":!0,"false-value":!1},null,512),[[ie,e(y).value.value]]),n(' <Icon class="icon" :data="privacyPolicyIcon" original :fill="false" /> '),a("span",Je,[d(" Signing in or logging in the Platform, you automaticaaly accept our "),Ke,d(" Privacy Policy and Terms and Conditions "),e(y).errorMessage.value?(u(),m("span",Qe,w(e(y).errorMessage.value),1)):n("v-if",!0)])])]),n(` <div class="information">
        This site is protected by reCAPTCHA and the Google
        <a href="https://policies.google.com/privacy"
          >Privacy Policy</a
        >
        and
        <a href="https://policies.google.com/terms"
          >Terms of Service</a
        >
        apply.
      </div> `),a("button",{class:"submitBtn",type:"submit",disabled:!e(j)}," Register ",8,We),a("span",Xe,[d(" Already have an account? "),I(p,{class:"link",to:{name:"login"}},{default:ne(()=>[d(" Login ")]),_:1})])],32)]))}}});const aa=he(Ye,[["__scopeId","data-v-c7806062"],["__file","/home/uche/apps/oly/oly_frontend/src/views/Register.vue"]]);export{aa as default};
//# sourceMappingURL=Register.js.map
