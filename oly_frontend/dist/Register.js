import{R as A,d as J,r as x,x as K,g as Q,s as W,U as X,G as Y,v as Z,a9 as ee,c as ae,X as se,aa as te,a as L,o as l,ab as oe,h as e,b as p,e as a,y as u,w as re,A as N,H as y,I,z as h,t as w,f as O,J as D,K as F,ac as ie,i as ne,L as le,M as B,N as ue,ad as de,Q as ce,S as ve,T as pe,V as me,W as ge,p as _e,k as fe,ae as ye,_ as he}from"./index.js";import{c as we,a as R,b as ke,u as Pe,d as k}from"./object.js";const be=d=>o=>{const c=o.target.getAttribute("name");c&&A(d,`values.${c}`)&&d.validateField(c)},m=d=>(_e("data-v-ef38d1d6"),d=d(),fe(),d),Me={key:1,class:"view entry register"},Ve={class:"header_section"},Ce=m(()=>a("h1",null,[u(" Create "),a("span",{class:"highlight"},"Patient"),u("/"),a("span",{class:"highlight"},"Therapist"),u(" Account ")],-1)),xe={class:"grouped"},Ne={class:"group small"},Re=m(()=>a("label",{for:"name"},"First Name",-1)),Se={key:0,class:"error"},Ue={class:"group small"},Te=m(()=>a("label",{for:"name"},"Last Name",-1)),Oe={key:0,class:"error"},Ie={class:"group"},Ae=m(()=>a("label",{for:"register_email"},"email",-1)),Ee={key:0,class:"error"},qe={class:"group"},Le=m(()=>a("label",{for:"register_password"},"password",-1)),De=["type"],Fe={key:0,class:"error"},Be={class:"group"},$e=m(()=>a("label",{for:"register_c_password"},"password confirmation",-1)),ze=["type"],je={key:0,class:"error"},He={class:"privacy_policy"},Ge={for:"privacy_policy"},Je={class:"text"},Ke=m(()=>a("a",{href:"https://www.iubenda.com/privacy-policy/71399601",class:"iubenda-nostyle no-brand iubenda-noiframe iubenda-embed iub-legal-only iubenda-noiframe link",title:"Privacy Policy "}," Privacy Policy ",-1)),Qe={key:0,class:"error"},We=["disabled"],Xe={class:"create"},Ye=J({__name:"Register",setup(d){const o=x("register"),i=K(),c=x(!1),n=Q(X,W),P=Y(),$=Z(),z=ee({loader:()=>ye(()=>import("./emailVerification.js"),["emailVerification.js","index.js","index.css","emailVerification.css"])}),j=we({name:R().required("Please input your first name"),lastName:R().required("Please input you last name"),email:R().email("Please input a valid email address").required("Please input a valid email address"),password:R().required("Please input a valid password"),password_confirmation:R().required("Please confirm your password").test({name:"confirm_password",exclusive:!0,params:{},message:"Password confirmation must match password",test:function(T){return T===this.parent.password}}),privacyPolicy:ke().required("Please accept to continue").oneOf([!0],"Please accept to continue")}),b=Pe({validationSchema:j,initialValues:{name:"",lastName:"",email:A($,"query.email","")||"",password:"",password_confirmation:"",privacyPolicy:!1}}),g=k("name",void 0,{validateOnValueUpdate:!0}),_=k("lastName",void 0,{validateOnValueUpdate:!0}),M=k("email",void 0,{validateOnValueUpdate:!0}),V=k("password",void 0,{validateOnValueUpdate:!0}),C=k("password_confirmation",void 0,{validateOnValueUpdate:!0}),f=k("privacyPolicy",void 0,{validateOnValueUpdate:!0,validateOnMount:!0}),H=ae(()=>(console.log("log",b.meta.value.valid),console.log("log",f.value.value),b.meta.value.valid&&f.value.value)),E=x(!1),G=async T=>{if(T.preventDefault(),c.value)return;const{valid:t}=await b.validate();if(!t){i.error("Ooops... some input / selection is invalid. Please verify inputed / selected data",{timeout:7e3,id:o.value});return}if(!(le||B&&P&&await P.recaptchaLoaded()))return i.error("Ooops.. cannot submit request at this time.. PLease refresh this page",{id:o.value,timeout:5e3}),!1;c.value=!0,i.info("Saving user data...",{id:o.value,timeout:0});try{const r=B?await(P==null?void 0:P.executeRecaptcha("register")):"token";let v=await ue.post("register",{json:{...b.values,firstName:g.value.value,lastName:_.value.value,"g-captcha-key":r}});if(v.status===200){const s=await v.json();de(s)&&(n.setToken(s.data.token),n.setState({userData:s.data.user}),E.value=!0,console.log("log",n.token),console.log("log",n))}i.dismiss(o.value)}catch(r){i.dismiss(o.value),r||window.location.reload(),(async()=>{if(r instanceof ce){const v=A(r,"response.status");if(v>=400){const s=await r.response.json();if(console.log("status",v),ve(s))i.error(s.message,{id:o.value,timeout:4e3});else{if(pe(s))return i.error(s.error.message,{id:o.value});if(me(s))return i.error("Authorization Error",{id:o.value})}}else if(r instanceof ge)return i.error("Ooops.. An error occured while sending request.. PLease check your internet connection",{id:o.value})}console.dir(r)})()}i.dismiss(o.value),c.value=!1},q=be(b);se(()=>{n.tokenCreationReason!==te.SIGNUP&&n.setState({email:"",tokenCreationReason:null,mode:n.mode==="token-sent"?"unlogged":n.mode})});const S=x(!1),U=x(!1);return(T,t)=>{const r=L("Icon"),v=L("router-link");return E.value?(l(),oe(e(z),{key:0})):(l(),p("div",Me,[a("div",Ve,[Ce,a("p",null,[u(" Already have an account? "),a("span",{class:"highlight",onClick:t[0]||(t[0]=re(()=>{},["prevent"]))},"Sign in")])]),a("form",{onSubmit:G,onChange:t[9]||(t[9]=(...s)=>e(q)&&e(q)(...s))},[a("div",xe,[a("div",Ne,[Re,a("span",{class:N(["input-icon",{"has-error":e(g).errorMessage.value}])},[y(a("input",{id:"name","onUpdate:modelValue":t[1]||(t[1]=s=>e(g).value.value=s),type:"text",name:"name",placeholder:"First Name"},null,512),[[I,e(g).value.value]])],2),e(g).errorMessage.value?(l(),p("div",Se,h(e(g).errorMessage.value),1)):w("",!0)]),a("div",Ue,[Te,a("span",{class:N(["input-icon",{"has-error":e(_).errorMessage.value}])},[y(a("input",{id:"name","onUpdate:modelValue":t[2]||(t[2]=s=>e(_).value.value=s),type:"text",name:"name",placeholder:"Last Name"},null,512),[[I,e(_).value.value]])],2),e(_).errorMessage.value?(l(),p("div",Oe,h(e(_).errorMessage.value),1)):w("",!0)])]),a("div",Ie,[Ae,a("span",{class:N(["input-icon",{"has-error":e(M).errorMessage.value}])},[y(a("input",{id:"register_email","onUpdate:modelValue":t[3]||(t[3]=s=>e(M).value.value=s),type:"email",name:"email"},null,512),[[I,e(M).value.value]]),O(r,{class:"icon",data:"@/assets/icons/mail.svg?icon"})],2),e(M).errorMessage.value?(l(),p("div",Ee,h(e(M).errorMessage.value),1)):w("",!0)]),a("div",qe,[Le,a("span",{class:N(["input-icon",{"has-error":e(V).errorMessage.value}])},[y(a("input",{id:"register_password","onUpdate:modelValue":t[4]||(t[4]=s=>e(V).value.value=s),type:S.value?"text":"password",name:"password"},null,8,De),[[D,e(V).value.value]]),O(r,{class:"icon toggle",data:e(F)(S.value),onClick:t[5]||(t[5]=s=>S.value=!S.value)},null,8,["data"])],2),e(V).errorMessage.value?(l(),p("div",Fe,h(e(V).errorMessage.value),1)):w("",!0)]),a("div",Be,[$e,a("span",{class:N(["input-icon",{"has-error":e(C).errorMessage.value}])},[y(a("input",{id:"register_c_password","onUpdate:modelValue":t[6]||(t[6]=s=>e(C).value.value=s),type:U.value?"text":"password",name:"cpassword"},null,8,ze),[[D,e(C).value.value]]),O(r,{class:"icon toggle",data:e(F)(U.value),onClick:t[7]||(t[7]=s=>U.value=!U.value)},null,8,["data"])],2),e(C).errorMessage.value?(l(),p("div",je,h(e(C).errorMessage.value),1)):w("",!0)]),a("div",He,[a("label",Ge,[y(a("input",{id:"privacy_policy","onUpdate:modelValue":t[8]||(t[8]=s=>e(f).value.value=s),type:"checkbox",name:"privacyPolicy","true-value":!0,"false-value":!1},null,512),[[ie,e(f).value.value]]),a("span",Je,[u(" Signing in or logging in the Platform, you automaticaaly accept our "),Ke,u(" Privacy Policy and Terms and Conditions "),e(f).errorMessage.value?(l(),p("span",Qe,h(e(f).errorMessage.value),1)):w("",!0)])])]),a("button",{class:"submitBtn",type:"submit",disabled:!e(H)}," Register ",8,We),a("span",Xe,[u(" Already have an account? "),O(v,{class:"link",to:{name:"login"}},{default:ne(()=>[u(" Login ")]),_:1})])],32)]))}}});const aa=he(Ye,[["__scopeId","data-v-ef38d1d6"]]);export{aa as default};
//# sourceMappingURL=Register.js.map
